(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3788:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/kyc",function(){return s(1383)}])},1383:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var r=s(5893),n=s(7294),l=s(1163),a=s(4033),o=s(11),i=s(7530),d=s(6501),c=s(7219);function u(){let e=(0,l.useRouter)(),{user:t,isAuthenticated:s,loading:u,updateUser:m}=(0,o.aC)(),[p,h]=(0,n.useState)(!1),[x,b]=(0,n.useState)(1),[f,g]=(0,n.useState)({phone:"",address:"",idNumber:""}),[y,j]=(0,n.useState)(""),[N,v]=(0,n.useState)({});if((0,n.useEffect)(()=>{u||s||e.push("/login")},[u,s,e]),(0,n.useEffect)(()=>{(null==t?void 0:t.kycCompleted)&&e.push("/dashboard")},[t,e]),u||!s)return(0,r.jsx)(a.Z,{title:"KYC Verification",children:(0,r.jsx)("div",{className:"min-h-[80vh] flex items-center justify-center",children:(0,r.jsx)("div",{className:"spinner w-12 h-12"})})});let w=e=>{let{name:t,value:s}=e.target;g(e=>({...e,[t]:s})),N[t]&&v(e=>({...e,[t]:""}))},P=()=>{let e={};return f.phone.trim()?/^[0-9]{10,15}$/.test(f.phone.replace(/\D/g,""))||(e.phone="Please enter a valid phone number (10-15 digits)"):e.phone="Phone number is required",v(e),0===Object.keys(e).length},O=async e=>{if(e.preventDefault(),P()){h(!0);try{(await i.uV.submit(f.phone.replace(/\D/g,""),f.address,f.idNumber)).success&&(await i.uV.sendOTP(),d.ZP.success("OTP sent to your phone number"),b(2))}catch(e){d.ZP.error(e.message||"Failed to submit KYC information")}finally{h(!1)}}},k=async t=>{if(t.preventDefault(),!y.trim()||y.length<4){v({otp:"Please enter a valid OTP"});return}h(!0);try{let t=await i.uV.verifyOTP(y);t.success&&(d.ZP.success("Phone verified successfully!"),m(t.data.user),e.push("/dashboard"))}catch(e){d.ZP.error(e.message||"Invalid OTP")}finally{h(!1)}},C=async()=>{h(!0);try{(await i.uV.sendOTP()).success&&d.ZP.success("OTP resent successfully")}catch(e){d.ZP.error("Failed to resend OTP")}finally{h(!1)}};return(0,r.jsx)(a.Z,{title:"KYC Verification",children:(0,r.jsx)("div",{className:"min-h-[80vh] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-gray-50 to-purple-50",children:(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 ".concat(x>=1?"text-purple-600":"text-gray-400"),children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center font-bold shadow-lg ".concat(x>=1?"bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-purple-500/30":"bg-gray-200"),children:x>1?(0,r.jsx)(c._rq,{className:"w-5 h-5"}):"1"}),(0,r.jsx)("span",{className:"text-sm font-medium hidden sm:inline",children:"Personal Info"})]}),(0,r.jsx)("div",{className:"w-12 h-1 rounded-full ".concat(x>=2?"bg-gradient-to-r from-purple-500 to-indigo-600":"bg-gray-200")}),(0,r.jsxs)("div",{className:"flex items-center gap-2 ".concat(x>=2?"text-purple-600":"text-gray-400"),children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center font-bold shadow-lg ".concat(x>=2?"bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-purple-500/30":"bg-gray-200"),children:"2"}),(0,r.jsx)("span",{className:"text-sm font-medium hidden sm:inline",children:"Verification"})]})]}),(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:1===x?"Complete Your Profile":"Verify Your Phone"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:1===x?"We need a few more details to verify your identity":"Enter the OTP sent to your phone number"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[1===x?(0,r.jsxs)("form",{onSubmit:O,className:"space-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone Number *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.tUt,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,r.jsx)("input",{id:"phone",name:"phone",type:"tel",value:f.phone,onChange:w,placeholder:"9876543210",className:"w-full pl-12 pr-4 py-3 border-2 rounded-xl transition-all outline-none focus:ring-4 ".concat(N.phone?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-200 focus:border-purple-500 focus:ring-purple-100")})]}),N.phone&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N.phone})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"address",className:"block text-sm font-semibold text-gray-700 mb-2",children:["Address ",(0,r.jsx)("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.i63,{className:"absolute left-4 top-3 text-gray-400 w-5 h-5"}),(0,r.jsx)("textarea",{id:"address",name:"address",value:f.address,onChange:w,rows:3,placeholder:"Enter your address",className:"w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl resize-none focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all outline-none"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"idNumber",className:"block text-sm font-semibold text-gray-700 mb-2",children:["ID Number ",(0,r.jsx)("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.XiQ,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,r.jsx)("input",{id:"idNumber",name:"idNumber",type:"text",value:f.idNumber,onChange:w,placeholder:"Aadhaar / PAN / Passport Number",className:"w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all outline-none"})]})]}),(0,r.jsx)("button",{type:"submit",disabled:p,className:"w-full py-4 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-semibold rounded-xl shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transition-all flex items-center justify-center gap-2 hover:scale-[1.02] disabled:opacity-50 disabled:hover:scale-100",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.dAq,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):(0,r.jsxs)(r.Fragment,{children:["Continue",(0,r.jsx)(c.Rgz,{className:"w-5 h-5"})]})})]}):(0,r.jsxs)("form",{onSubmit:k,className:"space-y-5",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-4 text-center border border-purple-100",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"OTP sent to"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["+91 ",f.phone]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"otp",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Enter OTP"}),(0,r.jsx)("input",{id:"otp",type:"text",value:y,onChange:e=>{j(e.target.value.replace(/\D/g,"").slice(0,6)),v({})},placeholder:"Enter 6-digit OTP",maxLength:6,className:"w-full px-4 py-4 text-center text-2xl tracking-widest font-mono border-2 rounded-xl transition-all outline-none focus:ring-4 ".concat(N.otp?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-200 focus:border-purple-500 focus:ring-purple-100")}),N.otp&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1 text-center",children:N.otp})]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 text-center",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,r.jsx)("strong",{children:"Demo Mode:"})," Use OTP ",(0,r.jsx)("code",{className:"bg-blue-100 px-2 py-1 rounded font-mono",children:"123456"})," to verify"]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:C,disabled:p,className:"text-purple-600 hover:text-purple-700 hover:underline text-sm font-medium",children:"Didn't receive OTP? Resend"})}),(0,r.jsx)("button",{type:"submit",disabled:p||y.length<4,className:"w-full py-4 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-semibold rounded-xl shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transition-all flex items-center justify-center gap-2 hover:scale-[1.02] disabled:opacity-50 disabled:hover:scale-100",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.dAq,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c._rq,{className:"w-5 h-5"}),"Verify & Continue"]})}),(0,r.jsx)("button",{type:"button",onClick:()=>b(1),className:"w-full py-3 border-2 border-gray-200 text-gray-700 font-medium rounded-xl hover:bg-gray-50 transition-all",children:"Back to Edit Phone"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"text-gray-500 hover:text-purple-600 text-sm transition-colors",children:"Skip for now â†’"})})]})]})})})}}},function(e){e.O(0,[814,219,33,774,888,179],function(){return e(e.s=3788)}),_N_E=e.O()}]);
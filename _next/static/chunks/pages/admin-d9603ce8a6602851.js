(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{4730:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return s(1507)}])},1507:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(5893),r=s(7294),l=s(1163),i=s(9008),c=s.n(i),d=s(1664),n=s.n(d),x=s(11);function o(){let e=(0,l.useRouter)(),{user:t,token:s,loading:i}=(0,x.aC)(),[d,o]=(0,r.useState)(null),[p,h]=(0,r.useState)([]),[m,u]=(0,r.useState)([]),[b,j]=(0,r.useState)("overview"),[N,g]=(0,r.useState)(!0),[y,v]=(0,r.useState)(null),[w,f]=(0,r.useState)(1),[k,D]=(0,r.useState)(1),[A,C]=(0,r.useState)(null),[_,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!i&&!t){e.push("/login");return}if(!i&&t&&"admin"!==t.role){e.push("/dashboard");return}t&&"admin"===t.role&&T()},[t,i,e]);let T=async()=>{try{g(!0);let e=await fetch("".concat("http://localhost:5000","/api/admin/stats"),{headers:{Authorization:"Bearer ".concat(s)}}),t=await e.json();t.success?o(t.data):v(t.message)}catch(e){console.error("Fetch stats error:",e),v("Failed to load admin statistics")}finally{g(!1)}},E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let t=await fetch("".concat("http://localhost:5000","/api/admin/users?page=").concat(e,"&limit=10"),{headers:{Authorization:"Bearer ".concat(s)}}),a=await t.json();a.success&&(h(a.data.users),C(a.data.pagination),f(e))}catch(e){console.error("Fetch users error:",e)}},P=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let t=await fetch("".concat("http://localhost:5000","/api/admin/reports?page=").concat(e,"&limit=10"),{headers:{Authorization:"Bearer ".concat(s)}}),a=await t.json();a.success&&(u(a.data.reports),S(a.data.pagination),D(e))}catch(e){console.error("Fetch reports error:",e)}},U=async e=>{try{let t=await fetch("".concat("http://localhost:5000","/api/admin/users/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({unlockAccount:!0})});(await t.json()).success&&(E(w),T())}catch(e){console.error("Unlock user error:",e)}},B=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(confirm("Are you sure you want to ".concat(t?"permanently delete":"deactivate"," this report?")))try{let a=await fetch("".concat("http://localhost:5000","/api/admin/reports/").concat(e,"?permanent=").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}});(await a.json()).success&&(P(k),T())}catch(e){console.error("Delete report error:",e)}};return((0,r.useEffect)(()=>{"users"===b&&0===p.length?E():"reports"===b&&0===m.length&&P()},[b]),i||N)?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-purple-200",children:"Loading admin dashboard..."})]})}):y?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center bg-red-500/10 p-8 rounded-lg",children:[(0,a.jsx)("p",{className:"text-red-400 text-lg",children:y}),(0,a.jsx)(n(),{href:"/dashboard",className:"text-purple-300 hover:text-white mt-4 inline-block",children:"← Back to Dashboard"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{children:[(0,a.jsx)("title",{children:"Admin Dashboard | Nexora Fraud Predictor"}),(0,a.jsx)("meta",{name:"description",content:"Admin dashboard for Nexora Fraud Predictor"})]}),(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[(0,a.jsx)("header",{className:"bg-black/20 backdrop-blur-lg border-b border-white/10",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n(),{href:"/dashboard",className:"text-purple-300 hover:text-white",children:"← Dashboard"}),(0,a.jsx)("h1",{className:"text-xl font-bold text-white",children:"\uD83D\uDEE1️ Admin Panel"})]}),(0,a.jsxs)("div",{className:"text-purple-300 text-sm",children:["Logged in as: ",(0,a.jsx)("span",{className:"text-white",children:null==t?void 0:t.name})]})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 mt-6",children:(0,a.jsx)("div",{className:"flex gap-2 border-b border-white/10 pb-2",children:["overview","users","reports"].map(e=>(0,a.jsx)("button",{onClick:()=>j(e),className:"px-4 py-2 rounded-t-lg transition-colors ".concat(b===e?"bg-purple-600 text-white":"text-purple-300 hover:text-white hover:bg-white/10"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6",children:["overview"===b&&d&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-purple-300 text-sm mb-1",children:"Total Users"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-white",children:d.users.total}),(0,a.jsxs)("div",{className:"text-green-400 text-sm mt-2",children:["+",d.users.newThisMonth," this month"]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-purple-300 text-sm mb-1",children:"Verified Users"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-green-400",children:d.users.verified}),(0,a.jsxs)("div",{className:"text-yellow-400 text-sm mt-2",children:[d.users.unverified," unverified"]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-purple-300 text-sm mb-1",children:"Total Reports"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-white",children:d.reports.total}),(0,a.jsxs)("div",{className:"text-blue-400 text-sm mt-2",children:[d.reports.active," active"]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("div",{className:"text-purple-300 text-sm mb-1",children:"Risk Checks Today"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-cyan-400",children:d.activity.riskChecksToday}),(0,a.jsx)("div",{className:"text-purple-300 text-sm mt-2",children:"queries performed"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"\uD83D\uDD12 Security Status"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-purple-300",children:"Locked Accounts"}),(0,a.jsx)("span",{className:"text-yellow-400",children:d.users.lockedAccounts})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-purple-300",children:"Blacklisted Tokens"}),(0,a.jsx)("span",{className:"text-red-400",children:d.security.blacklistedTokens})]})]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"\uD83D\uDCCA Reports by Category"}),(0,a.jsx)("div",{className:"space-y-2",children:d.reports.byCategory.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-purple-300",children:e._id}),(0,a.jsx)("span",{className:"text-white",children:e.count})]},e._id))})]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-6 border border-white/10",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"\uD83D\uDCCB Recent Activity"}),(0,a.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:d.activity.recentActivity.map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-white/5 last:border-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("login"===e.actionType?"bg-green-500/20 text-green-400":"register"===e.actionType?"bg-blue-500/20 text-blue-400":"check_risk"===e.actionType?"bg-purple-500/20 text-purple-400":"bg-gray-500/20 text-gray-400"),children:e.actionType}),(0,a.jsx)("span",{className:"text-purple-300 text-sm",children:(null===(s=e.userId)||void 0===s?void 0:s.email)||e.targetEntity||"Anonymous"})]}),(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:new Date(e.timestamp).toLocaleString()})]},t)})})]})]}),"users"===b&&(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl border border-white/10 overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-black/20",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"User"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Role"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Verified"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Joined"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:p.map(e=>(0,a.jsxs)("tr",{className:"border-t border-white/5 hover:bg-white/5",children:[(0,a.jsxs)("td",{className:"px-4 py-3",children:[(0,a.jsx)("div",{className:"text-white",children:e.name}),(0,a.jsx)("div",{className:"text-purple-400 text-sm",children:e.email})]}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("admin"===e.role?"bg-red-500/20 text-red-400":"moderator"===e.role?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"),children:e.role})}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.isEmailVerified?(0,a.jsx)("span",{className:"text-green-400",children:"✓ Yes"}):(0,a.jsx)("span",{className:"text-yellow-400",children:"✗ No"})}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.lockUntil&&new Date(e.lockUntil)>new Date?(0,a.jsx)("span",{className:"text-red-400",children:"\uD83D\uDD12 Locked"}):(0,a.jsx)("span",{className:"text-green-400",children:"✓ Active"})}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.lockUntil&&new Date(e.lockUntil)>new Date&&(0,a.jsx)("button",{onClick:()=>U(e._id),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded",children:"Unlock"})})]},e._id))})]})}),A&&(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-black/10",children:[(0,a.jsxs)("div",{className:"text-purple-300 text-sm",children:["Page ",A.page," of ",A.pages," (",A.total," total)"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>E(w-1),disabled:w<=1,className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white text-sm rounded",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>E(w+1),disabled:!A.hasMore,className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white text-sm rounded",children:"Next"})]})]})]}),"reports"===b&&(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl border border-white/10 overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-black/20",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Entity"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Type"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Category"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Reporter"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-purple-300 text-sm",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:m.map(e=>{var t;return(0,a.jsxs)("tr",{className:"border-t border-white/5 hover:bg-white/5",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-white font-mono text-sm",children:e.targetEntity}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs",children:e.entityType})}),(0,a.jsx)("td",{className:"px-4 py-3 text-white",children:e.category}),(0,a.jsx)("td",{className:"px-4 py-3 text-purple-300 text-sm",children:(null===(t=e.reporterId)||void 0===t?void 0:t.email)||"Anonymous"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.timestamp).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.isActive?(0,a.jsx)("span",{className:"text-green-400",children:"Active"}):(0,a.jsx)("span",{className:"text-gray-400",children:"Inactive"})}),(0,a.jsxs)("td",{className:"px-4 py-3 flex gap-2",children:[e.isActive&&(0,a.jsx)("button",{onClick:()=>B(e._id,!1),className:"px-3 py-1 bg-yellow-600 hover:bg-yellow-700 text-white text-sm rounded",children:"Deactivate"}),(0,a.jsx)("button",{onClick:()=>B(e._id,!0),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm rounded",children:"Delete"})]})]},e._id)})})]})}),_&&(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-black/10",children:[(0,a.jsxs)("div",{className:"text-purple-300 text-sm",children:["Page ",_.page," of ",_.pages," (",_.total," total)"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>P(k-1),disabled:k<=1,className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white text-sm rounded",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>P(k+1),disabled:!_.hasMore,className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white text-sm rounded",children:"Next"})]})]})]})]})]})]})}}},function(e){e.O(0,[814,774,888,179],function(){return e(e.s=4730)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{8356:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return s(4721)}])},4721:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var l=s(5893),a=s(7294),r=s(1163),i=s(4033),n=s(11),o=s(7530),d=s(6501),c=s(7219);function x(){let e=(0,r.useRouter)(),{user:t,isAuthenticated:s,loading:x,updateUser:m}=(0,n.aC)(),[g,u]=(0,a.useState)(!0),[p,h]=(0,a.useState)(!1),[b,f]=(0,a.useState)("protection"),[y,v]=(0,a.useState)({callProtection:{enabled:!1,registeredPhone:"",alertMode:"popup"},smsProtection:{enabled:!1,registeredPhone:"",alertMode:"popup"},emailProtection:{enabled:!1,registeredEmail:"",alertMode:"popup"}}),[j,N]=(0,a.useState)([]);(0,a.useEffect)(()=>{x||s||e.push("/login")},[x,s,e]),(0,a.useEffect)(()=>{s&&(w(),P())},[s]);let w=async()=>{try{let e=await o.P8.getSettings();e.success&&v(e.data.protectionSettings)}catch(e){console.error("Failed to fetch settings:",e),d.ZP.error("Failed to load settings")}finally{u(!1)}},P=async()=>{try{let t=await o.qF.getHistory(50);if(t.success){var e;N((null===(e=t.data)||void 0===e?void 0:e.alerts)||[])}}catch(e){console.error("Failed to fetch alert history:",e),N([])}},S=e=>{v(t=>({...t,[e]:{...t[e],enabled:!t[e].enabled}}))},k=(e,t,s)=>{v(l=>({...l,[e]:{...l[e],[t]:s}}))},A=async()=>{h(!0);try{let e=await o.P8.updateSettings(y);e.success?(d.ZP.success("Protection settings saved successfully!"),m&&e.data.user&&m(e.data.user)):d.ZP.error(e.message||"Failed to save settings")}catch(e){d.ZP.error(e.message||"Failed to save settings")}finally{h(!1)}},E=[{id:"callProtection",icon:c.tUt,title:"Call Protection",description:"Receive instant alerts before spam/fraud calls reach you",color:"blue",bgEnabled:"bg-blue-50 border-blue-500",bgIcon:"bg-blue-100",textIcon:"text-blue-600",field:"registeredPhone",placeholder:"Phone number (e.g., 9876543210)",inputType:"tel"},{id:"smsProtection",icon:c.IC0,title:"SMS Protection",description:"Get notified before spam/scam messages arrive",color:"green",bgEnabled:"bg-green-50 border-green-500",bgIcon:"bg-green-100",textIcon:"text-green-600",field:"registeredPhone",placeholder:"Phone number for SMS alerts",inputType:"tel"},{id:"emailProtection",icon:c.Imn,title:"Email Protection",description:"Alerts before phishing emails reach your inbox",color:"purple",bgEnabled:"bg-purple-50 border-purple-500",bgIcon:"bg-purple-100",textIcon:"text-purple-600",field:"registeredEmail",placeholder:"Email address to protect",inputType:"email"}],C=[{value:"popup",label:"Popup Alert",icon:c.vWP,description:"Show popup notification"},{value:"silent",label:"Silent",icon:c.LIZ,description:"Log only, no popup"},{value:"block",label:"Auto Block",icon:c.bfl,description:"Automatically block"}],I=[{id:"protection",label:"Protection Settings",icon:c.bfl},{id:"history",label:"Alert History",icon:c.bAx}],_=Object.values(y).filter(e=>e.enabled).length;return x||g?(0,l.jsx)(i.Z,{title:"Settings",children:(0,l.jsx)("div",{className:"min-h-[60vh] flex items-center justify-center",children:(0,l.jsx)(c.dAq,{className:"w-8 h-8 animate-spin text-primary-600"})})}):(0,l.jsx)(i.Z,{title:"Settings - Nexora Fraud Predictor",children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 max-w-4xl",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-500/30",children:(0,l.jsx)(c.nbt,{className:"w-7 h-7 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage your protection preferences"})]})]})}),(0,l.jsx)("div",{className:"flex gap-2 mb-6 bg-white p-2 rounded-2xl shadow-md border border-gray-100",children:I.map(e=>{let t=e.icon;return(0,l.jsxs)("button",{onClick:()=>f(e.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium transition-all ".concat(b===e.id?"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg shadow-purple-500/30":"text-gray-600 hover:bg-gray-100"),children:[(0,l.jsx)(t,{className:"w-5 h-5"}),e.label]},e.id)})}),"protection"===b&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"relative overflow-hidden bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 rounded-2xl p-6 mb-6 text-white shadow-xl",children:[(0,l.jsxs)("div",{className:"absolute inset-0 opacity-20",children:[(0,l.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/30 rounded-full blur-3xl transform translate-x-10 -translate-y-10"}),(0,l.jsx)("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white/30 rounded-full blur-3xl transform -translate-x-10 translate-y-10"})]}),(0,l.jsxs)("div",{className:"relative flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-bold",children:"Protection Status"}),(0,l.jsx)("p",{className:"text-white/80 mt-1",children:0===_?"No protection enabled - enable at least one to stay safe":"".concat(_," protection").concat(_>1?"s":""," active")})]}),(0,l.jsxs)("div",{className:"text-5xl font-bold",children:[_,"/3"]})]}),_>0&&(0,l.jsx)("div",{className:"relative flex gap-2 mt-4 flex-wrap",children:E.filter(e=>{var t;return null===(t=y[e.id])||void 0===t?void 0:t.enabled}).map(e=>(0,l.jsxs)("span",{className:"px-3 py-1 bg-white/20 rounded-full text-sm font-medium backdrop-blur-sm",children:["✓ ",e.title]},e.id))})]}),(0,l.jsx)("div",{className:"space-y-4",children:E.map(e=>{var t,s,a;let r=e.icon,i=null===(t=y[e.id])||void 0===t?void 0:t.enabled,n=(null===(s=y[e.id])||void 0===s?void 0:s[e.field])||"",o=(null===(a=y[e.id])||void 0===a?void 0:a.alertMode)||"popup";return(0,l.jsx)("div",{className:"bg-white rounded-2xl border-2 p-6 transition-all ".concat(i?e.bgEnabled:"border-gray-200"),children:(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("button",{type:"button",onClick:()=>S(e.id),className:"w-12 h-6 rounded-full relative transition-all duration-300 flex-shrink-0 ".concat(i?"bg-green-500 shadow-lg shadow-green-500/30":"bg-gray-300"),children:(0,l.jsx)("span",{className:"absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow-md transition-all duration-300 ".concat(i?"translate-x-6":"translate-x-0")})}),(0,l.jsx)("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0 ".concat(i?e.bgIcon:"bg-gray-100"),children:(0,l.jsx)(r,{className:"w-7 h-7 ".concat(i?e.textIcon:"text-gray-400")})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:e.title}),i&&(0,l.jsx)("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs font-semibold rounded-full",children:"ACTIVE"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),i&&(0,l.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"text-sm font-medium text-gray-700 block mb-1",children:["Protected ","registeredEmail"===e.field?"Email":"Phone"]}),(0,l.jsx)("input",{type:e.inputType,value:n,onChange:t=>k(e.id,e.field,t.target.value),placeholder:e.placeholder,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Alert Mode"}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-2",children:C.map(t=>{let s=t.icon,a=o===t.value;return(0,l.jsxs)("button",{type:"button",onClick:()=>k(e.id,"alertMode",t.value),className:"flex flex-col items-center gap-1 p-3 rounded-lg border-2 transition-all ".concat(a?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300 text-gray-600"),children:[(0,l.jsx)(s,{className:"w-5 h-5"}),(0,l.jsx)("span",{className:"text-xs font-medium",children:t.label})]},t.value)})})]})]})]})]})},e.id)})}),(0,l.jsx)("div",{className:"mt-8 flex justify-end",children:(0,l.jsx)("button",{onClick:A,disabled:p,className:"flex items-center gap-2 px-8 py-3 text-lg font-semibold bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white rounded-xl shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transition-all hover:scale-105 disabled:opacity-50 disabled:hover:scale-100",children:p?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.dAq,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.mW3,{className:"w-5 h-5"}),"Save Settings"]})})})]}),"history"===b&&(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden shadow-lg",children:[(0,l.jsxs)("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Alert History"}),(0,l.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"Your recent fraud/spam alerts"})]}),j&&0!==j.length?(0,l.jsx)("div",{className:"divide-y divide-gray-100",children:j.map(e=>{let t=E.find(t=>t.id.toLowerCase().includes(e.alertType)),s=(null==t?void 0:t.icon)||c.BJv;return(0,l.jsx)("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat((null==t?void 0:t.bgIcon)||"bg-gray-100"),children:(0,l.jsx)(s,{className:"w-5 h-5 ".concat((null==t?void 0:t.textIcon)||"text-gray-600")})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("span",{className:"font-medium text-gray-900",children:[e.alertType.toUpperCase()," Alert"]}),(0,l.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat("critical"===e.riskLevel?"bg-red-100 text-red-700":"high"===e.riskLevel?"bg-orange-100 text-orange-700":"medium"===e.riskLevel?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:e.riskLevel.toUpperCase()}),e.userAction&&(0,l.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat("blocked"===e.userAction?"bg-red-100 text-red-700":"allowed"===e.userAction?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:e.userAction.toUpperCase()})]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["From: ",(0,l.jsx)("span",{className:"font-mono",children:e.fromEntity}),e.category&&" • ".concat(e.category)]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 text-gray-500 text-sm",children:[(0,l.jsx)(c.TCC,{className:"w-4 h-4"}),new Date(e.createdAt).toLocaleDateString()]}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleTimeString()})]})]})},e._id)})}):(0,l.jsxs)("div",{className:"p-12 text-center",children:[(0,l.jsx)(c.bfl,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"No Alert History"}),(0,l.jsx)("p",{className:"text-gray-500 mt-1",children:"You haven't received any alerts yet"})]})]})]})})})}}},function(e){e.O(0,[814,219,33,774,888,179],function(){return e(e.s=8356)}),_N_E=e.O()}]);